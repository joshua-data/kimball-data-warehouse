### 1. 📦 소매 가치사슬에서의 재고의 위치

- 고객 관점의 가치사슬에서 재고는 **구매 이전 단계**에 위치함.
- 즉, 재고는 판매가 일어나기 전에 관리되어야 할 데이터임.
- 판매는 Transaction fact table로 처리되지만, 재고는 **주기적인 상태(snapshot)**로 관리해야 함.

---

### 2. 🧱 주기적 스냅샷 사실 테이블 (Periodic Snapshot Fact Table)

### 📌 개념

- 일정한 주기(예: 매일, 매주 등)로 저장되는 재고 상태 정보.
- 개별 거래를 저장하는 게 아니라, **정해진 시점에 전체 재고 상태**를 캡처해 저장.

### 🧾 예시 칼럼

| 날짜 | 제품ID | 지점ID | 보유수량 | 주문수량 | 백오더수량 |
| --- | --- | --- | --- | --- | --- |
| 2025-04-17 | 1234 | A01 | 30 | 5 | 2 |

### 🎯 주요 측정값

- On Hand Quantity (보유 수량)
- On Order Quantity (주문 수량)
- Backordered Quantity (백오더 수량)
- Returned Quantity (반품 수량) 등

---

### 3. 📐 설계 시 고려 사항

### ✅ Fact Table 설계

- Fact는 재고 관련 수치들이고, 모두 additive하진 않음.
- 일부 수치(예: 주문 수량)는 주간 또는 월간 합산 가능 (semi-additive).
- 비즈니스 프로세스 기준으로 매일 캡처하는 것이 일반적.

### ✅ Dimension Table

- 날짜
- 제품
- 지점
- 공급업체 (Vendor)
- 창고 (Warehouse)
- 시간대, 카테고리, 브랜드 등도 확장 가능

---

### 4. 🔄 DW 버스 아키텍처와 Inventory

### 📌 개념

- 여러 주제 영역(판매, 재고, 주문 등)이 공통된 **conformed dimension**을 공유함.
- 즉, 날짜, 제품, 지점 등의 dimension이 표준화되어 있어야 전체 시스템에서 **일관된 분석** 가능.

### 🧱 예시: 판매(Transactions)와 재고(Snapshots)가 모두 `Product Dim`, `Date Dim`, `Store Dim`을 공유함.

---

### 5. 🧠 인사이트 및 팁

- 주기적 스냅샷은 과거 상태를 추적할 수 있어 **트렌드 분석**에 유용.
- 재고는 거래가 아니라 상태이므로, Transaction table로 처리하면 안 됨.
- 판매와 재고를 연결해 **turnover rate**, **stock-to-sales ratio** 등의 KPI 계산 가능.
- 공급망 관리나 재고최적화(Inventory Optimization)에서 핵심적인 모델링 패턴임.

---

# 📘 Chapter 4 정리: 팩트 테이블 유형

팩트 테이블은 크게 세 가지 유형으로 분류됩니다.

- ✅ **트랜잭션 팩트 테이블 (Transaction Fact Table)**
- 📅 **주기적 스냅샷 팩트 테이블 (Periodic Snapshot Fact Table)**
- 🔄 **점진적 스냅샷 팩트 테이블 (Accumulating Snapshot Fact Table)**

이 세 가지는 서로 다른 목적과 특징을 가지며, 복합적으로 사용하는 경우도 많습니다.

---

## 🧾 1. 트랜잭션 팩트 테이블

> 특정 시점의 개별 이벤트(거래, 클릭, 주문 등)를 캡처하는 가장 기본적인 팩트 테이블
> 

### ✅ 특징

| 항목 | 설명 |
| --- | --- |
| 📌 주기 | 특정 이벤트 발생 순간 |
| 🔍 그레인 | 트랜잭션 또는 트랜잭션 라인 당 1 row |
| 📅 일자 | 트랜잭션 일자 |
| 📊 팩트 | 개별 트랜잭션 성과 |
| ⚠️ 희소성 | 활동 빈도에 따라 달라짐 |
| 🔄 갱신 | 거의 없음 (오류 수정 제외) |

### ✅ 사용 예시

- 주문, 결제, 장바구니 담기, 클릭 등
- 사용자 행동 분석에 용이

### ✅ 장단점

- **장점**: 가장 상세한 분석 가능
- **단점**: 업무 성과 요약에는 적합하지 않음

---

## 📅 2. 주기적 스냅샷 팩트 테이블

> 일정 간격(일, 주, 월 등)으로 누적된 성과를 스냅샷 형태로 기록하는 테이블
> 

### ✅ 특징

| 항목 | 설명 |
| --- | --- |
| 📌 주기 | 정기적이고 예측 가능한 주기 |
| 🔍 그레인 | 스냅샷 시점 + 디멘션 당 1 row |
| 📅 일자 | 스냅샷 일자 |
| 📊 팩트 | 기간 내 누적 성과 |
| ⚠️ 희소성 | 비교적 밀집됨 |
| 🔄 갱신 | 거의 없음 (오류 수정 제외) |

### ✅ 사용 예시

- 월별 판매 실적
- 주간 재고 스냅샷
- 일일 KPI 집계

### ✅ 장단점

- **장점**: 추세 분석, 성과 비교에 적합
- **단점**: 트랜잭션 데이터를 직접적으로 표현하지 않음

---

## 🔄 3. 점진적 스냅샷 팩트 테이블

> 프로세스의 마일스톤들을 기준으로 상태 변화를 기록하며, 시간이 지나며 갱신되는 테이블
> 

### ✅ 특징

| 항목 | 설명 |
| --- | --- |
| 📌 주기 | 파이프라인 혹은 워크플로우의 흐름 |
| 🔍 그레인 | 파이프라인 인스턴스당 1 row |
| 📅 일자 | 주요 마일스톤 별 복수 일자 |
| 📊 팩트 | 경과 시간, 완료 여부 등 |
| ⚠️ 희소성 | 케이스에 따라 희박하거나 밀집 |
| 🔄 갱신 | **반복적으로 갱신됨 (주요 특징)** |

### ✅ 사용 예시

- 주문 처리, 배송, 환불, 고객 문의 등 프로세스 분석
- SLA 분석, 이탈 시간 측정

### ✅ 장단점

- **장점**: 프로세스 효율성 분석 가능, 경과 시간 측정 용이
- **단점**: 설계 및 관리가 복잡하며, OLAP 큐브 구성 시 신중해야 함

---

## 🧩 비교 요약표

| 구분 | 트랜잭션 | 주기적 스냅샷 | 점진적 스냅샷 |
| --- | --- | --- | --- |
| 시점 | 순간 이벤트 | 일정 주기 | 프로세스 흐름 |
| 그레인 | 개별 이벤트 | 기간별 디멘션별 | 파이프라인별 |
| 일자 | 트랜잭션 일자 | 스냅샷 일자 | 다수의 마일스톤 일자 |
| 갱신 | 없음 | 없음 | 자주 갱신됨 |
| 용도 | 상세 이벤트 분석 | 누적 성과 트렌드 | 경과 시간 / 진행 상태 추적 |

---

## 📚 Chapter 4: 가치 사슬 통합 요약 학습 노트

### 🔑 핵심 개념 요약

### 1. **DW/BI 통합의 필요성**

- **경영진과 IT 모두 통합에 관심**: 고객 행동을 처음부터 끝까지 추적하거나, 제품/직원/학생 등의 전체적인 활동을 이해하려는 요구가 많음.
- **통합의 효과**:
    - 다양한 업무 프로세스를 엮어 **성과 분석과 예측의 정확도 향상**
    - **희소 자원 재사용성 증가**
    - **정보 자산을 체계적으로 관리**하는 책임 이행
- **성공 조건**:
    - 통합은 DW/BI 관리자만의 일이 아님.
    - **고위 경영진의 정치적 지원과 재무적 의지력이 핵심**.

---

### 🧩 2. **공유 디멘션을 통한 통합**

- 3장과 4장에서 다양한 프로세스를 개별 다차원 스키마로 모델링함.
- *공통 디멘션(일자, 제품, 지점 등)**은 여러 프로세스 팩트 테이블 간의 **논리적 연결고리 역할**.
- 📌 **그림 4-8**: 프로세스 간 디멘션 공유 구조 시각화
    
    (ex: 소매 판매, 재고, 창고 거래 팩트가 공통 디멘션 사용)
    

---

### 🚌 3. **전사적 데이터 웨어하우스 버스 아키텍처**

### 💡 개념 이해

- ‘버스’는 전력 및 컴퓨터 산업에서 유래된 용어.
    
    다양한 장치가 표준 인터페이스로 연결되는 구조 의미.
    
- **DW/BI에서 버스는 표준 디멘션과 팩트를 의미**
    
    → 서로 다른 팀이 별도로 모델링해도 **일관된 통합이 가능**.
    

### 🧱 구성 요소

- **표준 디멘션** + **프로세스별 팩트 테이블** 조합
- 각 업무 프로세스별 다차원 모델이 **퍼즐 조각처럼 맞춰짐**
- 결과적으로 전체 DW/BI 시스템이 통합된 구조를 가짐

### ⚙️ 장점

- **점진적 구축** 가능 (big-bang 방식 회피)
- **다양한 기술 스택**에 독립적 (관계형 DB, OLAP 등 모두 지원)
- **비동기식 개발팀도 아키텍처를 준수하여 협업 가능**

---

### 📊 4. **전사 DW 버스 매트릭스**

### 📐 정의

- DW 버스 아키텍처를 문서화한 표 형태
- 행: **업무 프로세스**
- 열: **표준 디멘션**
- 교차점(X): 해당 프로세스가 특정 디멘션을 사용하는 경우

### 📌 그림 4-10 예시 요약

| 업무 프로세스 | 일자 | 제품 | 지점 | 프로모션 | 고객 | 직원 |
| --- | --- | --- | --- | --- | --- | --- |
| 제조업체에 주문 |  | X |  |  |  | X |
| 창고에 입고 | X |  |  |  |  |  |
| 창고 재고 발생 | X | X |  |  |  |  |
| 상점에 입고 | X |  | X |  |  |  |
| 소매 판매 | X |  | X | X | X |  |
| 소매 예측 |  |  | X |  |  |  |
| 프로모션 추적 | X |  | X | X |  |  |
| 고객 반품 |  |  |  | X | X | X |
| 벤더 반품 | X |  |  |  |  |  |
| 단골 고객 분석 | X |  | X |  | X | X |
- 매트릭스를 통해 어떤 디멘션이 얼마나 자주, 어디에 사용되는지 파악 가능 → **공통 디멘션 후보 선정의 근거** 제공

---

### ✅ 핵심 정리

| 항목 | 요약 |
| --- | --- |
| 통합의 목표 | 가치사슬 전반을 아우르는 고객/제품/판매/재고/반품 등 전체적인 분석 가능하게 함 |
| 공유 디멘션의 역할 | 프로세스 간 연결고리로 사용되어 통합 모델 설계의 핵심 |
| 버스 아키텍처 | 일관된 구조의 DW/BI 구축을 위한 표준화된 프레임워크 |
| 전사 버스 매트릭스 | 아키텍처를 문서화하고 설계 일관성 유지에 도움 줌 |

---

## 재고 (Inventory): 표준 디멘션 학습 노트

### 1️⃣ 표준 디멘션이란?

- **정의**: 여러 개의 팩트 테이블에서 **공통적으로 사용되는 디멘션 테이블**
- **다른 명칭들**:
    - 공통 디멘션 (Common Dimension)
    - 마스터 디멘션 (Master Dimension)
    - 참조 디멘션 (Reference Dimension)
    - 공유 디멘션 (Shared Dimension)
- **생성 방식**: ETL 시스템에서 생성 → 논리적 또는 물리적으로 복제
- **중요성**: DW/BI 전사 환경에서 **일관된 분석 기반 제공**
    
    → CIO와 DW/BI 팀이 표준 디멘션 사용을 **정책적으로 강제**해야 함
    

---

### 2️⃣ 📊 팩트 테이블 간 드릴 어크로스 (Drill Across)

- **정의**: 서로 다른 팩트 테이블의 성과 측정치를 **하나의 리포트에서 결합 분석**
- **전제 조건**: 공통되는 표준 디멘션 속성 (예: `제품명`, `일자`) 기반
- **쿼리 방식**:
    - 멀티패스 SQL
    - OUTER JOIN, 특히 FULL OUTER JOIN 사용
- **BI 툴 용어 예시**:
    - multipass, multi-select, multi-fact, stitch query 등
- **주의사항**: 측정값은 조인된 후 BI 도구에서 **별도로 교차 계산 필요**

---

### 3️⃣ ✅ 표준 디멘션의 요건

- **일관성**:
    - 같은 디멘션 키
    - 같은 속성 이름과 정의
    - 같은 속성 값 (예: "7월" vs "칠월"은 비표준)
- **속성 명칭 통일**: `월`과 `월 이름`처럼 서로 다른 이름이면 안 됨
- **동일 물리 테이블일 수도 있지만** 일반적으로는 복제된 테이블로 존재함
- **속성 컬럼은 유일하게 명명되어야 함**

---

### 4️⃣ 🎯 다양한 형태의 표준 디멘션

### ① 동일한 표준 디멘션

- 팩트 테이블 간에 **정확히 같은 디멘션 사용**
- 예: 영업 팩트와 재고 팩트가 같은 `일자 디멘션` 사용

### ② 축소된 롤업 표준 디멘션 (Rollup Dimension)

- **속성의 부분집합**만 가진 디멘션
- 예: `브랜드 디멘션`은 `제품 디멘션`의 상위 레벨 정보만 가짐
- 전제: 속성명, 정의, 속성값이 정확히 일치해야 함

### ③ 일부 로우만을 가진 표준 디멘션

- 같은 수준의 디멘션이나 **일부 행만 존재**
- 예: `전사 제품 디멘션`에서 특정 업무만 사용하는 **부분집합 디멘션**
- 주의: 전체 제품 팩트와 조인 시 무결성 오류 발생 가능
    
    → 반드시 팩트 테이블과 디멘션의 범위 일치 필요
    

---

### 5️⃣ 💡 예시 정리

### ✅ 제품 디멘션 (상세)

| 속성명 | 예시 |
| --- | --- |
| 제품 키 (PK) | 10123 |
| 제품 명 | Fluffy Light Sliced White |
| 브랜드 명 | Fluffy |
| 제품 중분류 | 식빵 |
| 제품 대분류 | 제빵 |
| 패키지 타입명 | 비닐 |
| 패키지 사이즈 | 중형 |

### ✅ 브랜드 디멘션 (축소된 롤업)

| 속성명 | 예시 |
| --- | --- |
| 브랜드 키 (PK) | F123 |
| 브랜드 명 | Fluffy |
| 제품 중분류 | 식빵 |
| 제품 대분류 | 제빵 |

---

### 6️⃣ 주의 사항 정리

- 디멘션 속성과 키가 일치해야만 "표준"이라 부를 수 있음
- 일부 속성만 포함하거나 일부 로우만 있어도 표준화 가능 (조건 만족 시)
- 교차 팩트 테이블 분석 시 **데이터 정합성, 명칭 통일, 범위 일치** 필수
- 표준 디멘션은 **분석 유연성과 정확성의 핵심 기반**

---

### ✅ 데이터 거버넌스(Governance)

### 🔑 핵심 개념:

- 기업 전체적으로 **정의된 기준**, **데이터 소유자**, **관리 책임**을 정하는 체계.
- 데이터 웨어하우스는 데이터의 “**진실의 단일 버전** (single version of the truth)”을 제공해야 하므로, **모든 부서가 합의한 정의와 구조**가 필요.

### 💡 예시:

- "고객(Customer)"이라는 개념도 어떤 부서는 계약서를 기준으로, 다른 부서는 CRM 정보를 기준으로 보는 경우가 있음 → **모두가 동일하게 정의**하고 써야 함.

---

### ✅ 표준 차원(Standard Dimensions)

### 🔑 핵심 개념:

- 시간, 조직, 제품, 고객 등 여러 fact 테이블에서 반복적으로 참조되는 **공통 차원**.
- **전사적으로 표준화된 정의와 구조**로 구성.

### 📘 주요 특징:

1. **통합된 정의**: 각 부서가 동일한 의미로 사용.
2. **공유 가능**: 여러 fact 테이블에서 재사용.
3. **정제된 속성들**: 불필요하거나 혼란을 주는 속성은 제외.

### 📦 예시:

- 제품 차원(`dim_product`)에는 `product_id`, `product_name`, `brand`, `category`, `launch_date` 같은 속성이 들어감.
- 제품 단가를 여기에 넣는 건 위험 → 시간에 따라 변하므로, **fact 테이블**에 넣어야 함.

---

### ✅ 표준 사실(Standard Facts)

### 🔑 핵심 개념:

- 전사적으로 **정의가 통일된 수치형 지표**.
- 사실(Fact)은 매우 정확한 의미로 정의되어야 하며, **중복되거나 다른 의미로 해석되면 안 됨**.

### 📘 주의점:

- 단순히 `매출`이라는 이름으로 fact 테이블을 만들지 말고, **정확한 정의**가 있어야 함.
    - 예: gross_sales, net_sales, returns 등을 명확히 구분해야 함.

---

### ✅ 요약

| 항목 | 설명 |
| --- | --- |
| 데이터 거버넌스 | 데이터 정의, 품질, 책임 관리 등 전체 체계를 잡는 활동 |
| 표준 차원 | 여러 부서/시스템에서 동일하게 참조할 수 있도록 정의된 차원 테이블 |
| 표준 사실 | 조직 내에서 동일하게 이해되는 수치 지표 (fact 항목) |

---

### 📚 추가 팁

- **비즈니스 사용자 인터뷰**를 통해 정의 수립 시 모두가 이해하는 언어로 정의하는 것이 중요.
- Kimball 방법론에서는 **“명확한 정의 + 반복 가능성”**이 핵심입니다.