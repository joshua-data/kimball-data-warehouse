# 📘 학습 노트: 제9장 인적자원관리 (Human Resources)

## 🔍 개요

- 인적자원(HR) 데이터는 회계와 마찬가지로 조직 전반에 걸쳐 중요한 역할을 하며, 비즈니스 전반에서 폭넓게 사용됨
- 핵심 관심사: **직원 프로파일의 변경사항 추적**, **스냅샷 기반 인원 분석**, **조직 계층 구조**, **다중값 속성(스킬)** 처리 등
- 일반적인 KPI 중심의 모델링 외에도, 디멘션 테이블 자체만으로 인사이트 제공이 가능한 경우 존재

---

## 🧩 주요 개념 요약

### 1. **직원 프로파일 변경 추적 (Slowly Changing Dimensions - Type 2)**

### 🔸 상황

- 직원 한 명당 수십~수백 개의 속성(고용일, 직급, 급여, 소속, 학력 등)을 보유
- HR에서는 이 속성들의 변화를 시간에 따라 추적하고 분석하는 것이 중요

### 🔸 두 가지 접근

| 접근 방식 | 설명 |
| --- | --- |
| ① 이벤트 팩트 테이블 + 디멘션 | 트랜잭션 타입 디멘션과 함께 변경사항을 이벤트로 기록 |
| ② 스냅샷 기반 디멘션(추천) | 직원 디멘션 자체에 Type 2 이력 관리 적용하여, 변경된 속성과 사유를 함께 기록 |

### 🔸 설계 방법 (Type 2 디멘션)

- `직원 대체키(Surrogate Key)`를 디멘션 PK로 설정
- `원천 시스템 키(직원 ID)`는 일반 속성으로 포함
- `유효 시작일시` 및 `만료일시` 컬럼 추가
- `현재 여부 플래그`로 최신 상태 여부 표시
- **변경 사유(Change Reason)** 속성: LN(Last Name), ZIP(우편번호) 등으로 기록

---

### 2. **정확한 유효/만료 기간 관리**

- 일 단위 배치 시 → `유효일`, `만료일` 사용
- 시간 단위 적재 가능 시 → `유효일시`, `만료일시` 사용 (오전 9시 vs 오후 9시까지 구분 가능)

> ⚠️ 프로파일이 원래 상태로 되돌아가더라도 새 Row를 생성해야 함
> 
> 
> 기존 Row를 재사용하거나 만료일만 수정하면 안 됨
> 

---

### 3. **변경 사유 추적**

- ETL 레벨에서 파생되는 메타데이터를 실제 데이터에 함께 저장
- 다수의 속성이 한 번에 변경되었을 경우, 변경 사유를 문자열로 합쳐서 기록하거나 별도의 **브리지 테이블** 활용 가능
    - 예: `ChangeReason = "LastName ZIP"` 또는 별도 다대다 관계 테이블 생성

---

### 4. **직원 수 파악 및 시점 조회**

- 특정 시점의 전체 직원 수, 상세 프로파일, 부서별 분포 등을 분석 가능
- 쿼리 조건 예:
    
    ```sql
    WHERE '2024-01-01 10:00:00' >= 유효일시
      AND '2024-01-01 10:00:00' < 만료일시
    
    ```
    

---

### 5. **포괄적 프로파일 트랜잭션 식별**

- HR 원천 시스템에서는 개별 속성 변경이 마이크로 트랜잭션으로 저장될 수 있음
- DW/BI에서는 **의미 있는 단위의 트랜잭션 단위로 묶어서** 처리해야 함 (ex. 승진 포함 전체 정보 변경)
- 이 역할은 가능하다면 원천 시스템 또는 ETL에서 수행

---

## 📌 설계 시 고려사항 요약

| 고려사항 | 설명 |
| --- | --- |
| 디멘션 이력 관리 | Type 2 적용, 정확한 시간 단위 관리 필요 |
| 트랜잭션 타입 | 디멘션 속성으로 이관하여 스키마 단순화 |
| 변경 사유 기록 | ETL에서 메타데이터 추가 or 브리지 테이블 설계 |
| 다중값 처리 | 스킬/언어 등은 Outrigger나 Bridge로 설계 |
| 시간대 구분 | 동일 날짜 내의 변화를 고려한 `일시` 단위 사용 권장 |
| 최신 Row 구분 | `CurrentRowFlag` 사용해 현재 상태 빠르게 조회 |

---

## 🧠 학습 포인트 정리

- HR 데이터는 팩트 테이블 없이도 디멘션만으로 강력한 분석 기반이 가능하다
- SCD Type 2는 직원 데이터에 최적화된 설계 전략
- 시간 정확성과 변경 이력의 명확한 관리가 핵심
- 다중 속성 변경 시 **변경 사유 관리**는 데이터 해석력을 높이는 중요한 수단
- 단순한 속성 변경보다는 의미 있는 이벤트 단위(예: 승진, 부서이동)로 처리해야 조직 운영에 적합

---

## ✅ 직원수에 대한 주기적 스냅샷 (Periodic Snapshot of Headcount)

### 📌 목적

- HR 부서 및 관리자들은 월별로 다음과 같은 데이터를 파악하고자 함:
    - 총 직원 수
    - 총 급여 금액
    - 사용한/잔여 휴가 일수
    - 신규 채용 인원 수
    - 승진 인원 수 등

### 🧱 데이터 모델 구성

- 일반적인 **주기적 스냅샷 팩트 테이블**로 구성됨
- 3개의 주요 디멘션:
    - **월 디멘션**: 회사 달력 기준으로 월 단위 설명 제공
    - **직원 디멘션**: 해당 월 말일 기준 유효한 직원 정보
    - **조직 디멘션**: 직원이 소속된 조직(월 말 기준)

### 🔢 팩트 테이블 특징

- **집계 가능 팩트**: 월 단위 수치들은 모든 디멘션에서 합산 가능 (ex: 직원 수, 급여 합계 등)
- **부분 집계 팩트**: ‘잔여 ○○’ 등은 일부 디멘션에 대해선 합산 가능하나, **월 디멘션에 대해서는 평균값**을 사용하는 게 타당

---

## ✅ HR 프로세스 버스 매트릭스 (HR Process Bus Matrix)

### 📌 설명

- 직원 디멘션 (SCD Type 2) + 주기적 스냅샷 팩트는 좋은 시작이지만 **HR 프로세스는 훨씬 더 복잡함**

### 🔍 포함될 수 있는 팩트 테이블 유형

- 일부는 성과 지표를 포함하는 **트랜잭션 기반 팩트 테이블**
- 대부분은 **팩트 없는 팩트 테이블** (Factless Fact Tables)
    - 복리후생 자격
    - 복리후생 참여 등

### 🧠 시사점

- 버스 매트릭스를 통해 DW/BI 구축 범위를 구조화할 수 있으며, 어떤 팩트 유형이 필요한지 사전 계획 가능

---

## ✅ 패키지화된 분석 솔루션과 표준 데이터 모델 (Packaged Analytics and Standard Models)

### 📦 솔루션 개요

- 많은 조직들이 **상용 HR 애플리케이션**을 사용하며, 일부는 **DW/BI 모듈**이나 **표준 데이터 모델**도 포함
- 주요 목적: 구현 시간 단축, 개발 리스크 감소

### 🎯 장점

- 공통적인 HR 비즈니스 프로세스는 대부분 유사
- 초기 설계 시 DW/BI 팀의 부담을 줄이고 설계 가이드라인 제공

### ⚠️ 한계점 및 위험 요소

1. **업체 용어의 추상화**
    - 예: “party”, “role” 같은 추상적 명칭은 일반 사용자에게 낯설게 느껴질 수 있음
    - **비즈니스 용어를 반영하지 않는 모델은 사용자 몰입도 저하**
2. **원천 데이터와의 통합 문제**
    - 다른 내부 마스터 데이터와 conform되지 않는 경우, 고립된 데이터 사일로(silo) 발생
3. **품질 문제**
    - 일부 패키지 모델은 **디멘션 모델링 설계 오류**를 내포하고 있음
    - **원천 데이터 수집**에 집중된 설계일 수 있어, **BI 분석에 부적합**한 구조일 수 있음

### 💡 결론

- 표준 모델은 참고용으로 유용하지만, 진정한 데이터 모델은 **비즈니스와의 협업을 통해** 직접 설계할 때 가장 효과적임
- 고가의 패키지 모델보다, **비즈니스 사용자와 몇 주간 협력하여 설계한 모델이 훨씬 유용**

---

## 📚 요약

| 주제 | 주요 개념 | 주의 사항 |
| --- | --- | --- |
| **직원수 스냅샷** | 월별 직원 상태 통계 | 잔여값은 평균 사용 |
| **버스 매트릭스** | 다양한 HR 프로세스 구조화 | Factless Table 다수 포함 |
| **패키지 모델** | 빠른 도입, 설계 가이드 제공 | 용어 추상화, 통합 문제, 설계 오류 가능성 |

---

# 📘 직원 디멘션

## 🧩 1. 재귀적 직원 계층 (Recursive Employee Hierarchy)

### ✅ 기본 개념

- 직원 디멘션에서 **직원의 관리자**는 또 다른 직원이다 → 자기참조(recursive) 구조.
- 단순히 "관리자 이름"만 제공하는 것은 한계가 있다. → **분석 요구에 따라 설계 복잡도 증가**.

---

### 🛠️ 방법 1: 팩트 테이블에 직원 + 관리자 키 포함

- 팩트 테이블에 `직원 키` + `관리자 키` 두 개의 외래 키 포함.
- 각 키는 **롤플레잉 디멘션**의 직원 테이블과 연결.
    - 직원 디멘션 → 일반 속성
    - 관리자 디멘션 → 동일 테이블, 별칭만 '관리자'로 붙임

**장점**

- 분석 시, 직원 또는 관리자를 기준으로 동일한 방식으로 쿼리 가능 (성능 유사)
    
    **단점**
    
- 모든 팩트 테이블에 두 외래 키 추가 필요 → 설계 복잡도 증가

---

### 🛠️ 방법 2: 직원 디멘션에 관리자 키 포함 (Outrigger 사용)

- 직원 디멘션에 `관리자 키` 속성 추가 → **Outrigger 테이블**로 롤플레잉 디멘션과 조인

**Type 2로 관리할 경우 주의**

- 직원이 아닌 **관리자의 변경**도 직원을 새로 생성하게 되는 **연쇄적 업데이트** 발생 가능
- 예: CEO 한 명의 프로파일 변경으로 수백 명 디멘션 로우 재생성

**대안**

- `관리자 키`를 **지속성 있는 원천 키 (durable key)** 로 사용 → 현재 프로파일만 연결
- 또는 `Type 1` 속성으로 관리 → 변경 이력은 남기지 않지만 단순 구조 유지

---

### 🔄 관리 계층의 Drill-Up / Drill-Down

- 단순한 관리자 관계는 `직원-관리자` 1단계로 표현 가능 (롤플레잉 or Outrigger)
- 하지만 **전체 관리자 체인**(ex. 3~5단계까지)은 다음 접근이 필요함

---

### 🔗 브리지 테이블 (Bridge Table) 방식

- `직원-관리자` 관계를 다단계(Recursive)로 표현
- 한 관리자에 대해 **직·간접적인 모든 하위 직원들**이 포함된 다수의 로우 생성
- 유효일자, 종료일자를 통해 계층 변경 이력까지 관리 가능

**장점**

- OLAP 툴과 연동하여 Drill Down 가능
- 고급 분석 (ex. 관리 체인 전체를 통해 성과 분석) 지원

**단점**

- 설계 및 관리 복잡도 증가
- 변경 이력 추적 시 브리지 테이블의 폭발적 증가 가능
- 일반 BI 사용자에게는 사용 난이도가 높음 → **경량 BI 앱에 숨겨야 함**

---

### 🧪 기타 대안

- `Pathstring` 같은 경로 기반 속성 (ex. “CEO > VP > Manager > 직원”)
- SQL의 재귀 CTE나 Oracle의 `CONNECT BY` 사용
- 다만 비기술 사용자에게는 어려움 → **브리지 테이블 + 유효일자 구조**가 가장 현실적

---

## 🧠 2. 다중 값 스킬 키워드 속성 (Multi-Valued Skill Keywords)

### ✅ 문제 상황

- 직원 1명이 복수의 기술 스킬셋 보유 (ex. Python, Linux, SQL 등)
- 직원 디멘션에 단일 속성으로 표현하기 어렵고 확장성 부족

---

### 🛠️ 방법 1: 이진 속성 방식

- 디멘션에 '리눅스 있음/없음', 'Python 있음/없음' 같은 이진 속성 추가

**장점**

- 쿼리 성능 우수, 단순한 필터링
    
    **단점**
    
- 스킬 수 증가에 따라 **디멘션 폭발**, 확장성 한계

---

### 🛠️ 방법 2: 스킬 키워드 브리지 테이블

- 별도 `스킬 키워드` 테이블 + `직원-스킬` 브리지 테이블 설계
- 직원 1명당 N개의 스킬 키워드 연결 가능

**예시**

```
dim_employee
- employee_key | employee_name

dim_skill
- skill_key | skill_name

bridge_employee_skill
- employee_key | skill_key

```

**장점**

- 확장성 우수
- 다대다 관계 표현 가능
- 필터링, 집계 가능

**단점**

- 쿼리 복잡도 증가
- 일반 BI 사용자에게는 다소 어려움

---

### 🎯 실무 설계 팁

| 분석 목적 | 추천 방법 |
| --- | --- |
| 단일 관리자만 필요 | 직원 디멘션에 관리자 키 포함 (Type 1) |
| 계층적 관리자 분석 | 브리지 테이블 + 유효일자 |
| 간단한 스킬만 필터 | 직원 디멘션에 이진 속성 |
| 다양한 스킬 조합 분석 | 스킬 브리지 테이블 |

---

## 📌 정리 요약

| 주제 | 설계 방식 | 장점 | 단점 |
| --- | --- | --- | --- |
| 재귀적 관리자 관계 | 팩트에 직원/관리자 키 | 분석 성능 좋음 | 테이블마다 키 중복 |
| 직원 디멘션에 관리자 키 | 구조 간단 | 연쇄 업데이트 위험 |  |
| 브리지 테이블 | Drill Down 가능 | 설계 복잡, 관리 부담 |  |
| 다중 스킬 속성 | 이진 속성 | 쿼리 쉬움 | 확장성 부족 |
| 스킬 키워드 브리지 | 유연한 설계 | 쿼리 복잡 |  |

---

# 📘 HR 데이터와 설문조사 다차원 모델링 노트

## 1. 📝 설문조사 데이터의 다차원 모델링

### ✅ 개요

- HR 부서는 **동료 평가**, **관리자 평가**, **만족도 조사** 등의 데이터를 설문 형태로 수집.
- 이 데이터를 다차원적으로 분석하기 위해 **사실(Fact) 테이블**과 **디멘션(Dimension) 테이블**을 구성.

### ✅ 팩트 테이블 설계

- 각 설문 응답 **한 질문당 하나의 row**로 저장.
- 측정값: 응답 점수 (예: 1~5점)
- 핵심 외래 키 구성:
    - `응답자 직원` (Employee - role: responder)
    - `평가 대상 직원` (Employee - role: subject)
    - `설문조사` (Survey)
    - `질문` (Question)
    - `응답` (Response – 선택된 답변 값)

### ✅ 디멘션 구성

| 디멘션 | 설명 |
| --- | --- |
| **직원 디멘션 (2개 역할)** | 응답자와 평가 대상자. 동일 테이블에서 역할만 다름. |
| **설문조사 디멘션** | 설문 제목, 목적, 작성일 등 메타 정보. |
| **질문 디멘션** | 질문 내용, 유형(예: 선택형, 서술형), 카테고리 등. |
| **응답 디멘션** | 선택형 응답 값의 정의. 긍정/부정 분류 등도 포함 가능. |

> ✨ 동일 질문이 여러 설문에 사용될 수 있으므로, 질문 디멘션은 설문조사 디멘션과 독립되어야 함.
> 

---

## 2. 💬 텍스트 코멘트 다루기

### ✅ 문제 정의

- 설문조사, 성과 리뷰에는 **자유 서술형 코멘트**가 포함되는 경우가 많음.
- 이는 수치화되지 않으며, 팩트도 디멘션도 아닌 특수한 형태의 데이터.

### ⚠️ 설계 유의사항

- 텍스트 코멘트를 팩트 테이블에 저장하는 것은 ❌ **비효율적**:
    - 크기 팽창
    - 성과 지표 쿼리 성능 저하 가능
    - 퇴화 디멘션처럼 사용할 수 없음

### ✅ 권장 방안

| 설계 방안 | 설명 |
| --- | --- |
| **코멘트 디멘션 분리** | 동일 코멘트가 자주 반복되는 경우 (ex. 무응답 포함), 별도 디멘션으로 관리. |
| **트랜잭션 디멘션 속성으로 저장** | 각 응답마다 코멘트가 유일한 경우, 트랜잭션 디멘션 내 속성으로 저장. |

> 🔍 대부분의 분석은 수치 중심으로 이루어지므로, 텍스트 필드는 쿼리에 큰 영향을 주지 않도록 별도로 분리하는 것이 핵심.
> 

---

## 3. ✅ 요약 정리

- **직원 디멘션**은 HR 시스템에서 다양한 프로세스를 통합적으로 표현할 수 있는 핵심 디멘션.
- **설문조사 데이터 모델**은 슬라이싱 앤 다이싱(slicing and dicing)을 통한 다차원 분석이 가능하도록 설계되어야 함.
- **텍스트 코멘트**는 팩트 테이블에서 분리하여 성능과 유지관리성을 확보.
- 실무에서는 사용자 요구(텍스트 포함 여부)와 시스템 성능 간 균형이 필요함.

---