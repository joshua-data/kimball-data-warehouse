## 1. 🌐 조달(Purchasing) 프로세스 개요

### ✅ 조달의 중요성

- **조달**은 기업이 제품이나 서비스를 내부 사용 또는 재판매를 위해 획득하는 모든 활동을 포함함.
- 거의 모든 산업에 적용 가능하며, 효율적인 조달은 **비용 절감과 수익성 향상**에 핵심적.

### ✅ 조달 프로세스에 포함되는 활동

- 계약 협상
- 구매 요청 및 PO(Purchase Order) 발행
- 입고 및 품질 검사
- 지불 승인 및 회계 처리

---

## 2. 🧠 비즈니스 분석 관점에서의 핵심 질문

- 가장 많이 구매한 자재/제품은 무엇인가?
- 동일 제품에 대해 얼마나 많은 공급자가 있으며, 가격 차이는?
- 사내 직원들이 협상된 공급업체에서 구매하고 있는가?
- 계약된 가격과 실제 구매 가격 간 차이는 있는가?
- 공급업체의 납기 성능, 백오더율, 불량률 등은?

---

## 3. 🧱 팩트 테이블 및 디멘션 구성

### ✅ 조달 트랜잭션 팩트 테이블

- 각 조달 행위를 하나의 로우로 구성
- 주요 디멘션:
    - 트랜잭션 일자
    - 제품
    - 공급업자
    - 계약조건
    - 조달 트랜잭션 유형
- 주요 팩트:
    - 트랜잭션 수량
    - 트랜잭션 금액

### ✅ 주요 디멘션 예시

| 디멘션 | 설명 |
| --- | --- |
| 제품 디멘션 | 제품명, 카테고리, 브랜드 등 |
| 공급업자 디멘션 | 업체명, 주소, 국가, 모회사 등 |
| 계약조건 디멘션 | 협상 조건 설명, 계약 유형 등 |
| 트랜잭션 유형 디멘션 | 구매 주문, 입고, 지불 등 |
| 계약번호 (퇴화 디멘션) | 계약 식별자 |

---

## 4. 🔀 단일 vs 다수 트랜잭션 팩트 테이블

### ✅ 설계상의 딜레마

- **단일 팩트 테이블 사용**: 조달의 전체 파이프라인을 하나의 테이블로 통합 → 비교 및 통합 분석 용이
- **다수 팩트 테이블 사용**: 각 조달 단계(PO, 입고, 지불 등)의 상세 속성 차이를 반영하기 쉬움

### ✅ 고려 요소

- 원천 데이터의 구조보다 **비즈니스 요구사항**이 우선
- 조달 트랜잭션의 속성 차이와 분석 방식에 따라 유연하게 판단

---

## 5. 🧩 퇴화 디멘션과 컨트롤 번호

- 조달 프로세스에서는 다양한 트랜잭션이 발생하고, 각각 **고유한 컨트롤 번호**가 존재함
- 예: 주문 번호, 납품 번호, 송장 번호 등
- 이들은 모두 퇴화 디멘션(degenerate dimension)의 이상적인 후보

---

## 6. 🧬 디멘션 이력 관리 (SCD: Slowly Changing Dimension)

### ✅ 디멘션 속성 변화의 필요성

- 제품 카테고리 재편성
- 고객 주소 변경
- 공급업자 정보 갱신 등

### ✅ SCD 관리 유형 (Type 0 ~ Type 7)

| 타입 | 설명 |
| --- | --- |
| **Type 0** | 변경 없음 (정적 디멘션) |
| **Type 1** | 기존 값 덮어쓰기 |
| **Type 2** | 변경 이력 저장 (row versioning) |
| **Type 3** | 이전 값과 현재 값을 함께 저장 (column versioning) |
| **Type 4** | 별도 이력 테이블 분리 |
| **Type 5** | Type 1 + surrogate key를 포함한 현재 뷰 |
| **Type 6** | Type 1 + 2 + 3 결합 |
| **Type 7** | Dual-mode: 현재 값과 이력 값 모두 관리 가능 |

> 💡 Type 2는 가장 일반적인 방식으로, 변경 이력을 분석에 활용할 수 있도록 설계함.
> 

---

## ✅ 1. 보완적인 조달 스냅샷

### 📌 개념 요약

- **점진적 스냅샷**(Accumulating Snapshot): 제품이 조달 파이프라인을 통해 어떻게 이동하고 있는지를 추적.
- **각 단계의 마일스톤과 소요 시간**을 저장하여 **진행 상태를 모니터링**할 수 있음.
- **종료 시점이 있는 프로세스**에 적합함 (예: 발주 → 입고 → 품질검사 등).
- **끝나지 않는 연속적인 흐름**에는 적합하지 않음 (예: 지속되는 계약 관리 등).

### 📌 중요 포인트

- 여러 트랜잭션 테이블과 별도로 **스냅샷 테이블을 추가 개발**할 수 있음.
- **비즈니스의 모니터링 니즈**를 충족시키기 위한 중요한 수단임.

---

## ✅ 2. 디멘션 이력 관리 개요 (Slowly Changing Dimensions, SCD)

### 📌 개념 요약

- 디멘션 속성은 **시간이 지나면서 변할 수 있음**.
- 모든 속성 변경을 **팩트 테이블에 담으려는 시도는 비현실적**.
- 디멘션 내에서 변경을 다룰 수 있는 전략이 필요.
- 속성마다 **적절한 변경 처리 전략(SCD Type)**을 지정해야 함.

### 📌 협업과 의사결정

- **현업 데이터 거버넌스 담당자**와 **협업 사용자 대표**가 변경 관리 전략에 적극적으로 참여해야 함.
- 변경 추적 필요 여부를 **요구사항 단계에서 명확히 파악**할 것.

---

## ✅ 3. 디멘션 이력 관리의 다양한 유형 (SCD Types)

---

### 🟠 Type 0: 최초 값 유지

| 특징 | 내용 |
| --- | --- |
| 정의 | 최초 값만 유지하고, 변경을 무시함 |
| 용도 | "최초 값"이 중요한 속성 (예: 최초 등록일, 최초 신용등급) |
| 예외 | 날짜 디멘션 속성 등 |

---

### 🟠 Type 1: 덮어쓰기 (Overwrite)

| 특징 | 내용 |
| --- | --- |
| 정의 | 속성 값을 덮어써서 가장 최신 상태만 유지 |
| 용도 | 과거 값이 중요하지 않거나 추적할 필요 없는 속성 |
| 장점 | 구현이 가장 쉬움 |
| 단점 | 변경 이력이 모두 소실됨, 리포트 결과가 시점에 따라 달라질 수 있음 |

### 📌 예시

- 제품 "인텔리키즈"의 카테고리가 '교육' → '전략'으로 변경
- 기존 로우를 **업데이트만 하고 키는 그대로 유지**
- 이로 인해 **과거 매출까지 전략 카테고리로 롤업**됨

### 📌 주의사항

- 기존 OLAP 큐브, 집계 테이블은 **모두 재계산 필요**
- 동일 리포트를 시점에 따라 다르게 볼 수 있음
- 집계 결과가 일관되지 않을 수 있음

---

### 📌 Type 3: 속성 추가 방식 (Add New Attribute)

### ✅ 정의

- **디멘션 테이블에 새로운 컬럼을 추가**해서 변경 이력을 관리하는 방식.
- **새로운 로우를 생성하지 않음.**
- 과거 값과 현재 값을 **같은 로우에서 함께 보존**할 수 있음.

### ✅ 특징

| 항목 | 설명 |
| --- | --- |
| 로우 추가 여부 | ❌ 없음 |
| 컬럼 추가 여부 | ✅ 있음 (예: 이전 카테고리명) |
| 용도 | **이전/현재 계층**을 비교해서 보고 싶을 때 |
| 사용 빈도 | 낮음 (특정 시나리오에만 적합) |
| OLAP 큐브 | 변경 후 **재처리 필요** |

### ✅ 예시

- 제품의 **카테고리**가 "교육"에서 "전략"으로 변경됨.
- 디멘션 컬럼에 `현재 카테고리명`, `이전 카테고리명`을 함께 둠.

```
제품 키   | 제품 설명   | 현재 카테고리명 | 이전 카테고리명
--------|-------------|----------------|----------------
12345   | 인텔리키즈 | 전략           | 교육

```

### ✅ 활용 예

- **영업조직 개편** 등에서, 과거 매출 실적을 과거 기준으로도 보고 싶을 때.
- 일정 기간 동안 **신구 구조를 모두 고려**해서 분석하는 과도기 시나리오.

### ⚠️ 주의점

- **예측 불가능한 변경**(예: 고객의 주거형태)에는 적합하지 않음 → Type 2로 처리
- **복수 컬럼**이 추가되면, 관리 복잡성 증가
- BI 도구에서 **칼럼명 명확화 필수** (예: `2022 카테고리명`, `합병 전 카테고리명`)

---

### 📌 Type 4: 미니 디멘션 (Mini Dimension)

### ✅ 정의

- 자주 변경되거나 분석에 자주 사용되는 디멘션 속성을 **별도 디멘션 테이블로 분리**.
- 이 미니 디멘션을 팩트 테이블에 **외래키로 연결**함.

### ✅ 특징

| 항목 | 설명 |
| --- | --- |
| 목적 | **속성 변경 잦은 경우** 성능 개선 & 변경 이력 관리 |
| 적용 대상 | 고객의 나이, 소득수준, 구매점수 등 |
| 디멘션 키 | 원래 디멘션 키 + 미니 디멘션 키 (복합키 형태) |

### ✅ 장점

- **디멘션 테이블 로우 수 감소** → 성능 개선
- 변경이 자주 일어나도 **디멘션 테이블이 비대해지지 않음**
- 속성 값의 **조합 기준으로 하나의 로우** 생성

### ✅ 예시

- 고객 속성(나이, 소득수준, 구매빈도 점수)을 미니 디멘션으로 분리
- 나이: 20대, 30대 / 소득수준: 2천만원 이하, 2~4천만원 등 → **범위 구간화 필요**

```
[고객 미니 디멘션]
미니 디멘션 키 | 나이 | 소득구간    | 구매빈도 점수
-------------|-----|------------|---------------
1            | 30대 | 2000~4000  | 낮음
2            | 20대 | 4000~6000  | 높음

```

### ✅ 팁

- **연속형 변수 → 범주형 구간**으로 변환하는 것이 핵심
- 그렇지 않으면 미니 디멘션 테이블도 커져서 본래 목적을 달성 못함

---

### 🧠 정리: Type 3 vs. Type 4

| 항목 | Type 3 | Type 4 |
| --- | --- | --- |
| 방식 | 새로운 컬럼 추가 | 별도 디멘션 생성 |
| 로우 증가 여부 | ❌ 없음 | ✅ 미니 디멘션에는 있음 |
| 적합한 경우 | 과거 & 현재 계층 분석 | 자주 변경되는 속성 추적 |
| 주요 대상 | 제품 라인, 조직구조 | 고객 속성, 행동 속성 등 |
| 장점 | 두 가지 뷰 동시 제공 | 성능 향상, 변경 관리 유리 |

---

# ✅ 하이브리드 디멘션 이력 관리 기법 정리

## 📌 하이브리드 기법이란?

- 기존의 SCD (Slowly Changing Dimension) 타입들을 **조합**한 방식
- 더 높은 **분석 유연성**을 제공하지만, **복잡성**도 증가
- ⚠️ **비즈니스 사용자들이 요구하지 않는다면 불필요하게 도입하지 말 것**

---

## 🧩 SCD Type 5: Type 4 + Type 1 Outrigger

### 🔹 구성

- **타입 4 미니 디멘션** + **기본 디멘션의 타입 1 속성 (아웃리거)**
- 기본 디멘션 테이블에 **현재 미니 디멘션 키**를 속성으로 추가
- 이 속성은 변경 시 **덮어쓰기(Type 1)**로 관리됨

### 🔹 사용 목적

- **현재 상태 기반의 분석이 필요한 경우**:
    - 예: 현재 고객 속성에 따라 과거 판매량을 롤업
- **팩트 테이블 지표 없이도 현재 속성 기준 카운트 가능**

### 🔹 장점

- 현재 속성과 과거 속성의 **병렬적 접근 가능**
- **폭발적인 로우 수 증가 회피**

### 🔹 단점

- 미니 디멘션과 아웃리거 디멘션의 **이중 접근 경로**로 사용자 혼란 가능
- **프레젠테이션 영역에서 통합 뷰** 제공 필요

### 🔹 예시 구조

```
<고객 디멘션>
고객키 (PK), 고객명, 현재_나이구간, 현재_소득수준 (← 아웃리거 속성)

<인구통계학 미니 디멘션>
인구통계학키 (PK), 나이구간, 소득수준 (← 타입 4 관리)

<팩트 테이블>
고객키 (FK), 인구통계학키 (FK), 현재_인구통계학키 (FK), 판매량 등

```

---

## 🧩 SCD Type 6: Type 1 + Type 2 + Type 3 조합

### 🔹 구성

- 하나의 디멘션 로우에
    - **현재 속성 (Type 1)**: 덮어쓰기
    - **이력 속성 (Type 2)**: 로우 분리
    - **이전 속성 (Type 3)**: 별도 칼럼

### 🔹 사용 목적

- 과거 이력을 정확히 보존하면서도, **현재 속성 기준 롤업**도 가능

### 🔹 작동 방식

- 변화가 생기면 **신규 로우 생성(Type 2)**
- 새 로우에는
    - `현재 속성`: 현재 기준값으로 덮어쓰기
    - `이력 속성`: 변화 직전 값을 보관

### 🔹 장점

- **과거 기준 분석**과 **현재 기준 분석**을 모두 가능하게 함

### 🔹 단점

- 관리할 칼럼이 많아져 복잡성 증가

### 🔹 예시 구조

| 제품키 | 제품코드 | 제품설명 | 이력_카테고리 (Type 2) | 현재_카테고리 (Type 1) | 시작일 | 종료일 | 현재여부 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 12345 | ABC922-Z | 인텔리키즈 | 교육 | 전략 | 2012-01-01 | 2013-01-31 | N |
| 25984 | ABC922-Z | 인텔리키즈 | 전략 | 비판적 사고 | 2013-02-01 | 2013-06-30 | N |
| 31726 | ABC922-Z | 인텔리키즈 | 비판적 사고 | 비판적 사고 | 2013-07-01 | 9999-12-31 | Y |

---

## 🧩 SCD Type 7: 로우 수준 접근 제어 확장 (간단 소개)

- **타입 7은 수학적 의미보다 단순히 다음 버전 넘버로 명명**
- 때로는 **정책 변경에 따라 다른 속성 조합의 선택적 사용**을 의미함
- 책에서는 구체적으로 다루지 않지만, **설계자들이 커스터마이징한 기법**에 해당함

---

## 💡 총정리: 하이브리드 기법 비교

| 기법 | 조합 | 사용 이유 | 장점 | 단점 |
| --- | --- | --- | --- | --- |
| Type 5 | Type 4 + Type 1 | 현재 속성 기준 분석 | 로우 수 증가 방지 | 사용자 혼란 가능 |
| Type 6 | Type 1 + 2 + 3 | 이력+현재 기준 분석 병행 | 유연한 분석 | 칼럼 관리 복잡 |
| Type 7 | 커스텀 | 정책 기반 제어 | 유연성 ↑ | 정의 명확 X |

---